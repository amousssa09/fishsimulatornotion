<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé£ Simulador de Pesca Pixel</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Press Start 2P', monospace;
            background: linear-gradient(180deg, #87CEEB 0%, #4682B4 50%, #191970 100%);
            min-height: 100vh;
            color: white;
            overflow-x: auto;
        }
        
        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(0,0,0,0.8);
            padding: 20px;
            border-radius: 15px;
            border: 3px solid #FFD700;
        }
        
        .stats-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .stat {
            background: rgba(0,0,0,0.7);
            padding: 10px 15px;
            border-radius: 10px;
            border: 2px solid #4169E1;
            font-size: 10px;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px 350px;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .fishing-area {
            background: rgba(0,20,40,0.9);
            border-radius: 15px;
            padding: 25px;
            border: 3px solid #20B2AA;
            text-align: center;
        }
        
        .pond {
            width: 100%;
            height: 300px;
            background: linear-gradient(180deg, #4682B4 0%, #191970 100%);
            border-radius: 20px;
            border: 4px solid #1E90FF;
            position: relative;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .water-effect {
            position: absolute;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                90deg,
                transparent,
                transparent 20px,
                rgba(255,255,255,0.1) 20px,
                rgba(255,255,255,0.1) 40px
            );
            animation: wave 3s linear infinite;
        }
        
        @keyframes wave {
            0% { transform: translateX(-40px); }
            100% { transform: translateX(0px); }
        }
        
        .fishing-rod {
            position: absolute;
            right: 20px;
            top: -10px;
            font-size: 30px;
            z-index: 10;
        }
        
        .catch-display {
            margin: 20px 0;
            min-height: 80px;
            background: rgba(0,0,0,0.6);
            border-radius: 10px;
            padding: 15px;
            border: 2px solid #32CD32;
        }
        
        .fish-caught {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 10px 0;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
        }
        
        .fish-icon {
            font-size: 24px;
        }
        
        .fish-info {
            flex: 1;
            text-align: left;
        }
        
        .fish-name {
            font-size: 12px;
            margin-bottom: 5px;
        }
        
        .fish-rarity {
            font-size: 8px;
            padding: 2px 6px;
            border-radius: 5px;
            display: inline-block;
        }
        
        .rarity-common { background: #808080; }
        .rarity-uncommon { background: #32CD32; }
        .rarity-rare { background: #1E90FF; }
        .rarity-epic { background: #9932CC; }
        .rarity-legendary { background: #FFD700; color: black; }
        .rarity-mythic { background: linear-gradient(45deg, #FF1493, #00FFFF); }
        
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 20px;
            font-family: inherit;
            font-size: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #FF6347, #FF4500);
            color: white;
            border-color: #FF6347;
        }
        
        .btn-primary:hover {
            background: linear-gradient(45deg, #FF4500, #FF6347);
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: linear-gradient(45deg, #4169E1, #1E90FF);
            color: white;
            border-color: #4169E1;
        }
        
        .btn-secondary:hover {
            background: linear-gradient(45deg, #1E90FF, #4169E1);
            transform: translateY(-2px);
        }
        
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .panel {
            background: rgba(0,0,0,0.8);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid #4169E1;
        }
        
        .panel h3 {
            color: #FFD700;
            margin-bottom: 15px;
            font-size: 12px;
            text-align: center;
        }
        
        .equipment-slot {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 10px 0;
            padding: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            font-size: 8px;
        }
        
        .shop-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 8px 0;
            padding: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            font-size: 8px;
        }
        
        .shop-item button {
            padding: 4px 8px;
            font-size: 6px;
            background: #32CD32;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        
        .task-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 8px 0;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            font-size: 8px;
            border-left: 3px solid #FFD700;
        }
        
        .task-item.completed {
            background: rgba(0,255,0,0.1);
            border-left-color: #32CD32;
            opacity: 0.7;
            text-decoration: line-through;
        }
        
        .task-description {
            flex: 1;
            margin-right: 10px;
        }
        
        .complete-btn {
            padding: 4px 8px;
            font-size: 6px;
            background: #32CD32;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        
        .complete-btn:disabled {
            background: #666;
            cursor: not-allowed;
        }
        
        .delete-btn {
            padding: 4px 6px;
            font-size: 6px;
            background: #FF4500;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            margin-left: 5px;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
        }
        
        .modal-content {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            margin: 15% auto;
            padding: 20px;
            border: 2px solid #FFD700;
            border-radius: 15px;
            width: 80%;
            max-width: 500px;
            font-family: inherit;
            color: white;
        }
        
        .modal h3 {
            color: #FFD700;
            margin-bottom: 15px;
            text-align: center;
            font-size: 12px;
        }
        
        .modal input {
            width: 100%;
            padding: 10px;
            font-size: 10px;
            border: 2px solid #4169E1;
            border-radius: 5px;
            margin-bottom: 15px;
            font-family: inherit;
            background: rgba(255,255,255,0.1);
            color: white;
        }
        
        .modal input::placeholder {
            color: #ccc;
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .inventory {
            max-height: 300px;
            overflow-y: auto;
            background: rgba(0,0,0,0.6);
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
        }
        
        .inventory-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px;
            margin: 3px 0;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            font-size: 7px;
        }
        
        .fishing-progress {
            width: 100%;
            height: 20px;
            background: rgba(0,0,0,0.5);
            border-radius: 10px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #32CD32, #228B22);
            width: 0%;
            transition: width 0.3s;
            border-radius: 10px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.9);
            color: #FFD700;
            padding: 10px 15px;
            border-radius: 8px;
            border: 2px solid #FFD700;
            font-size: 8px;
            z-index: 1000;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s;
        }
        
        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .tabs {
            display: flex;
            margin-bottom: 15px;
        }
        
        .tab {
            flex: 1;
            padding: 8px;
            background: rgba(255,255,255,0.1);
            border: none;
            color: white;
            font-family: inherit;
            font-size: 8px;
            cursor: pointer;
            border-radius: 5px 5px 0 0;
        }
        
        .tab.active {
            background: #4169E1;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .stats-bar {
                justify-content: center;
            }
            
            .stat {
                font-size: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>üé£ SIMULADOR DE PESCA PIXEL üé£</h1>
            <p style="font-size: 8px; margin-top: 10px;">¬°Completa tareas para ganar puntos de pesca y descubre criaturas incre√≠bles!</p>
        </div>
        
        <div class="stats-bar">
            <div class="stat">üí∞ Monedas: <span id="coins">0</span></div>
            <div class="stat">üé£ Puntos de Pesca: <span id="fishingPoints">5</span></div>
            <div class="stat">üêü Peces Capturados: <span id="totalCatch">0</span></div>
            <div class="stat">‚≠ê Nivel: <span id="level">1</span></div>
            <div class="stat">üìà EXP: <span id="exp">0</span>/<span id="expNeeded">100</span></div>
        </div>
        
        <div class="main-content">
            <div class="fishing-area">
                <h2>üåä Zona de Pesca</h2>
                <div class="pond">
                    <div class="water-effect"></div>
                    <div class="fishing-rod">üé£</div>
                </div>
                
                <div class="fishing-progress">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                
                <div class="catch-display" id="catchDisplay">
                    <p style="font-size: 10px;">¬°Haz clic en "Pescar" para empezar tu aventura!</p>
                </div>
                
                <div class="controls">
                    <button class="btn btn-primary" onclick="fish()">üé£ Pescar (1 punto)</button>
                    <button class="btn btn-secondary" onclick="resetTasks()">üîÑ Reiniciar D√≠a</button>
                    <button class="btn btn-secondary" onclick="sellAll()">üí∞ Vender Todo</button>
                </div>
            </div>
            
            <div class="panel">
                <h3>üìã MIS TAREAS DEL D√çA</h3>
                <div class="controls" style="margin-bottom: 15px;">
                    <button class="btn btn-secondary" onclick="showAddTaskModal()" style="width: 100%; font-size: 8px;">‚ûï A√±adir Nueva Tarea</button>
                </div>
                <div id="taskList"></div>
                <div style="text-align: center; margin-top: 15px; font-size: 7px; color: #87CEEB;">
                    Completa tus tareas reales para ganar puntos de pesca
                </div>
            </div>
            
            <div class="sidebar">
                <div class="panel">
                    <h3>‚öôÔ∏è EQUIPAMIENTO</h3>
                    <div class="equipment-slot">
                        <span>üé£ Ca√±a:</span>
                        <span id="currentRod">B√°sica</span>
                    </div>
                    <div class="equipment-slot">
                        <span>ü™ù Anzuelo:</span>
                        <span id="currentHook">Simple</span>
                    </div>
                    <div class="equipment-slot">
                        <span>üßµ Sedal:</span>
                        <span id="currentLine">Normal</span>
                    </div>
                    <div class="equipment-slot">
                        <span>üéØ Suerte:</span>
                        <span id="luckBonus">+0%</span>
                    </div>
                </div>
                
                <div class="panel">
                    <div class="tabs">
                        <button class="tab active" onclick="switchTab('shop')">üõí TIENDA</button>
                        <button class="tab" onclick="switchTab('inventory')">üì¶ INVENTARIO</button>
                    </div>
                    
                    <div id="shop" class="tab-content active">
                        <div id="shopItems"></div>
                    </div>
                    
                    <div id="inventory" class="tab-content">
                        <div class="inventory" id="inventoryList"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal para a√±adir tarea -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <h3>‚ûï A√±adir Nueva Tarea</h3>
            <input type="text" id="taskInput" placeholder="Ej: Estudiar matem√°ticas 1 hora" maxlength="50">
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="addNewTask()">‚úÖ A√±adir</button>
                <button class="btn btn-secondary" onclick="closeAddTaskModal()">‚ùå Cancelar</button>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification"></div>
    
    <script>
        // Estado del juego
        let gameState = {
            coins: 0,
            fishingPoints: 0, // Empezamos con 0, se ganan completando tareas
            totalCatch: 0,
            level: 1,
            exp: 0,
            expNeeded: 100,
            equipment: {
                rod: 'basic',
                hook: 'simple',
                line: 'normal'
            },
            inventory: {},
            luckBonus: 0,
            dailyTasks: [], // Tareas reales del usuario
            tasksCompleted: 0
        };
        
        // Ya no necesitamos base de datos de tareas predefinidas
        // Las tareas las crea el usuario
        
        // Base de datos de peces
        const fishDatabase = {
            // COMUNES (70% probabilidad)
            'sardina': { name: 'Sardina', icon: 'üêü', rarity: 'common', value: 5, exp: 2 },
            'anchoa': { name: 'Anchoa', icon: 'üê†', rarity: 'common', value: 6, exp: 2 },
            'caballa': { name: 'Caballa', icon: 'üêü', rarity: 'common', value: 8, exp: 3 },
            'arenque': { name: 'Arenque', icon: 'üê†', rarity: 'common', value: 7, exp: 2 },
            'boquer√≥n': { name: 'Boquer√≥n', icon: 'üêü', rarity: 'common', value: 6, exp: 2 },
            'jurel': { name: 'Jurel', icon: 'üê†', rarity: 'common', value: 9, exp: 3 },
            'carpa': { name: 'Carpa', icon: 'üêü', rarity: 'common', value: 12, exp: 4 },
            'lucio': { name: 'Lucio', icon: 'üê†', rarity: 'common', value: 15, exp: 5 },
            
            // POCO COMUNES (20% probabilidad)
            'lubina': { name: 'Lubina', icon: 'üêü', rarity: 'uncommon', value: 25, exp: 8 },
            'dorada': { name: 'Dorada', icon: 'üê†', rarity: 'uncommon', value: 30, exp: 10 },
            'salm√≥n': { name: 'Salm√≥n', icon: 'üêü', rarity: 'uncommon', value: 35, exp: 12 },
            'trucha': { name: 'Trucha', icon: 'üê†', rarity: 'uncommon', value: 28, exp: 9 },
            'besugo': { name: 'Besugo', icon: 'üêü', rarity: 'uncommon', value: 32, exp: 11 },
            'lenguado': { name: 'Lenguado', icon: 'üê†', rarity: 'uncommon', value: 38, exp: 13 },
            
            // RAROS (7% probabilidad)
            'at√∫n': { name: 'At√∫n', icon: 'üêü', rarity: 'rare', value: 75, exp: 25 },
            'pez_espada': { name: 'Pez Espada', icon: '‚öîÔ∏è', rarity: 'rare', value: 85, exp: 30 },
            'mero': { name: 'Mero Gigante', icon: 'üê†', rarity: 'rare', value: 68, exp: 22 },
            'pulpo': { name: 'Pulpo', icon: 'üêô', rarity: 'rare', value: 72, exp: 24 },
            'calamar': { name: 'Calamar Gigante', icon: 'ü¶ë', rarity: 'rare', value: 80, exp: 28 },
            'tibur√≥n_blanco': { name: 'Tibur√≥n Blanco', icon: 'ü¶à', rarity: 'rare', value: 120, exp: 40 },
            
            // √âPICOS (2.5% probabilidad)
            'pez_dorado': { name: 'Pez Dorado M√°gico', icon: 'üê†', rarity: 'epic', value: 200, exp: 60 },
            'drag√≥n_marino': { name: 'Drag√≥n Marino', icon: 'üêâ', rarity: 'epic', value: 250, exp: 75 },
            'sirena': { name: 'Cola de Sirena', icon: 'üßú‚Äç‚ôÄÔ∏è', rarity: 'epic', value: 300, exp: 90 },
            'kraken_joven': { name: 'Kraken Juvenil', icon: 'üêô', rarity: 'epic', value: 350, exp: 100 },
            'ballena_azul': { name: 'Ballena Azul', icon: 'üêã', rarity: 'epic', value: 280, exp: 80 },
            
            // LEGENDARIOS (0.4% probabilidad)
            'leviat√°n': { name: 'Leviat√°n', icon: 'üê≤', rarity: 'legendary', value: 800, exp: 200 },
            'poseid√≥n_pez': { name: 'Pez de Poseid√≥n', icon: 'üî±', rarity: 'legendary', value: 1000, exp: 250 },
            'f√©nix_acu√°tico': { name: 'F√©nix Acu√°tico', icon: 'üî•', rarity: 'legendary', value: 1200, exp: 300 },
            'cristal_viviente': { name: 'Cristal Viviente', icon: 'üíé', rarity: 'legendary', value: 1500, exp: 400 },
            
            // M√çTICOS (0.1% probabilidad)
            'guardi√°n_oce√°nico': { name: 'Guardi√°n del Oc√©ano', icon: 'üëë', rarity: 'mythic', value: 5000, exp: 1000 },
            'dios_pez': { name: 'Dios Pez Ancestral', icon: '‚≠ê', rarity: 'mythic', value: 10000, exp: 2000 }
        };
        
        // Tienda
        const shopData = {
            rods: [
                { id: 'bamboo', name: 'Ca√±a de Bamb√∫', price: 100, luckBonus: 5 },
                { id: 'carbon', name: 'Ca√±a de Carbono', price: 500, luckBonus: 15 },
                { id: 'titanium', name: 'Ca√±a de Titanio', price: 2000, luckBonus: 30 },
                { id: 'legendary', name: 'Ca√±a Legendaria', price: 10000, luckBonus: 60 }
            ],
            hooks: [
                { id: 'iron', name: 'Anzuelo de Hierro', price: 50, luckBonus: 3 },
                { id: 'steel', name: 'Anzuelo de Acero', price: 200, luckBonus: 8 },
                { id: 'enchanted', name: 'Anzuelo Encantado', price: 800, luckBonus: 20 },
                { id: 'divine', name: 'Anzuelo Divino', price: 5000, luckBonus: 45 }
            ],
            lines: [
                { id: 'thick', name: 'Sedal Grueso', price: 75, luckBonus: 4 },
                { id: 'kevlar', name: 'Sedal de Kevlar', price: 300, luckBonus: 10 },
                { id: 'diamond', name: 'Sedal de Diamante', price: 1500, luckBonus: 25 },
                { id: 'cosmic', name: 'Sedal C√≥smico', price: 8000, luckBonus: 50 }
            ]
        };
        
        // Probabilidades de rareza
        const rarityChances = {
            common: 70,
            uncommon: 20,
            rare: 7,
            epic: 2.5,
            legendary: 0.4,
            mythic: 0.1
        };
        
        // Funciones principales
        function updateDisplay() {
            document.getElementById('coins').textContent = gameState.coins;
            document.getElementById('fishingPoints').textContent = gameState.fishingPoints;
            document.getElementById('totalCatch').textContent = gameState.totalCatch;
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('exp').textContent = gameState.exp;
            document.getElementById('expNeeded').textContent = gameState.expNeeded;
            document.getElementById('luckBonus').textContent = '+' + gameState.luckBonus + '%';
            
            updateEquipmentDisplay();
            updateInventoryDisplay();
            updateShopDisplay();
            updateTaskDisplay();
        }
        
        function updateEquipmentDisplay() {
            const rodNames = { basic: 'B√°sica', bamboo: 'Bamb√∫', carbon: 'Carbono', titanium: 'Titanio', legendary: 'Legendaria' };
            const hookNames = { simple: 'Simple', iron: 'Hierro', steel: 'Acero', enchanted: 'Encantado', divine: 'Divino' };
            const lineNames = { normal: 'Normal', thick: 'Grueso', kevlar: 'Kevlar', diamond: 'Diamante', cosmic: 'C√≥smico' };
            
            document.getElementById('currentRod').textContent = rodNames[gameState.equipment.rod];
            document.getElementById('currentHook').textContent = hookNames[gameState.equipment.hook];
            document.getElementById('currentLine').textContent = lineNames[gameState.equipment.line];
        }
        
        function calculateLuckBonus() {
            let bonus = 0;
            
            // Bonificaciones del equipamiento
            shopData.rods.forEach(rod => {
                if (gameState.equipment.rod === rod.id) bonus += rod.luckBonus;
            });
            shopData.hooks.forEach(hook => {
                if (gameState.equipment.hook === hook.id) bonus += hook.luckBonus;
            });
            shopData.lines.forEach(line => {
                if (gameState.equipment.line === line.id) bonus += line.luckBonus;
            });
            
            gameState.luckBonus = bonus;
        }
        
        function getRarityFromRoll(roll) {
            // Aplicar bonificaci√≥n de suerte
            const luckFactor = 1 + (gameState.luckBonus / 100);
            
            if (roll <= rarityChances.mythic * luckFactor) return 'mythic';
            if (roll <= (rarityChances.mythic + rarityChances.legendary) * luckFactor) return 'legendary';
            if (roll <= (rarityChances.mythic + rarityChances.legendary + rarityChances.epic) * luckFactor) return 'epic';
            if (roll <= (rarityChances.mythic + rarityChances.legendary + rarityChances.epic + rarityChances.rare) * luckFactor) return 'rare';
            if (roll <= 90) return 'uncommon';
            return 'common';
        }
        
        function getRandomFishByRarity(rarity) {
            const fishOfRarity = Object.keys(fishDatabase).filter(key => fishDatabase[key].rarity === rarity);
            return fishOfRarity[Math.floor(Math.random() * fishOfRarity.length)];
        }
        
        function fish() {
            if (gameState.fishingPoints <= 0) {
                showNotification('‚ùå No tienes puntos de pesca. ¬°Completa tareas!');
                return;
            }
            
            gameState.fishingPoints--;
            
            // Animaci√≥n de progreso
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = '0%';
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                progressBar.style.width = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(interval);
                    completeFishing();
                }
            }, 100);
        }
        
        function completeFishing() {
            const roll = Math.random() * 100;
            const rarity = getRarityFromRoll(roll);
            const fishKey = getRandomFishByRarity(rarity);
            const fish = fishDatabase[fishKey];
            
            // A√±adir al inventario
            if (!gameState.inventory[fishKey]) {
                gameState.inventory[fishKey] = 0;
            }
            gameState.inventory[fishKey]++;
            
            // Ganar experiencia y monedas
            gameState.exp += fish.exp;
            gameState.totalCatch++;
            
            // Verificar subida de nivel
            checkLevelUp();
            
            // Mostrar captura
            displayCatch(fish);
            showNotification('¬°Capturaste ' + fish.name + '! +' + fish.exp + ' EXP');
            
            updateDisplay();
        }
        
        function displayCatch(fish) {
            const catchDisplay = document.getElementById('catchDisplay');
            catchDisplay.innerHTML = 
                '<div class="fish-caught">' +
                    '<div class="fish-icon">' + fish.icon + '</div>' +
                    '<div class="fish-info">' +
                        '<div class="fish-name">' + fish.name + '</div>' +
                        '<div class="fish-rarity rarity-' + fish.rarity + '">' + fish.rarity.toUpperCase() + '</div>' +
                        '<div style="font-size: 8px; margin-top: 5px;">üí∞ ' + fish.value + ' monedas | ‚≠ê ' + fish.exp + ' EXP</div>' +
                    '</div>' +
                '</div>';
        }
        
        function checkLevelUp() {
            while (gameState.exp >= gameState.expNeeded) {
                gameState.exp -= gameState.expNeeded;
                gameState.level++;
                gameState.expNeeded = Math.floor(gameState.expNeeded * 1.5);
                gameState.fishingPoints += 2; // Bonus por subir de nivel
                
                showNotification('¬°NIVEL ' + gameState.level + '! +2 puntos de pesca bonus');
            }
        }
        
        function sellAll() {
            let totalValue = 0;
            let fishCount = 0;
            
            for (const fishKey in gameState.inventory) {
                const quantity = gameState.inventory[fishKey];
                const fish = fishDatabase[fishKey];
                totalValue += fish.value * quantity;
                fishCount += quantity;
            }
            
            if (fishCount === 0) {
                showNotification('‚ùå No tienes peces para vender');
                return;
            }
            
            gameState.coins += totalValue;
            gameState.inventory = {};
            
            showNotification('¬°Vendiste ' + fishCount + ' peces por ' + totalValue + ' monedas!');
            updateDisplay();
        }
        
        function updateInventoryDisplay() {
            const inventoryList = document.getElementById('inventoryList');
            inventoryList.innerHTML = '';
            
            const sortedFish = Object.keys(gameState.inventory).sort((a, b) => {
                const rarityOrder = { mythic: 6, legendary: 5, epic: 4, rare: 3, uncommon: 2, common: 1 };
                return rarityOrder[fishDatabase[b].rarity] - rarityOrder[fishDatabase[a].rarity];
            });
            
            for (const fishKey of sortedFish) {
                const quantity = gameState.inventory[fishKey];
                if (quantity > 0) {
                    const fish = fishDatabase[fishKey];
                    const item = document.createElement('div');
                    item.className = 'inventory-item';
                    item.innerHTML = 
                        '<span>' + fish.icon + ' ' + fish.name + ' x' + quantity + '</span>' +
                        '<span class="fish-rarity rarity-' + fish.rarity + '">' + fish.rarity + '</span>';
                    inventoryList.appendChild(item);
                }
            }
            
            if (sortedFish.length === 0) {
                inventoryList.innerHTML = '<p style="text-align: center; color: #666;">Inventario vac√≠o</p>';
            }
        }
        
        function updateShopDisplay() {
            const shopItemsElement = document.getElementById('shopItems');
            shopItemsElement.innerHTML = '';
            
            // Ca√±as
            const rodsSection = document.createElement('div');
            rodsSection.innerHTML = '<h4 style="color: #FFD700; margin: 10px 0; font-size: 10px;">üé£ CA√ëAS</h4>';
            shopItemsElement.appendChild(rodsSection);
            
            shopData.rods.forEach(rod => {
                if (gameState.equipment.rod !== rod.id) {
                    const item = document.createElement('div');
                    item.className = 'shop-item';
                    item.innerHTML = 
                        '<div>' +
                            '<div>' + rod.name + '</div>' +
                            '<div style="font-size: 6px; color: #32CD32;">+' + rod.luckBonus + '% Suerte</div>' +
                        '</div>' +
                        '<button onclick="buyItem(\'rod\', \'' + rod.id + '\', ' + rod.price + ')" ' + (gameState.coins < rod.price ? 'disabled' : '') + '>' +
                            'üí∞ ' + rod.price +
                        '</button>';
                    shopItemsElement.appendChild(item);
                }
            });
            
            // Anzuelos
            const hooksSection = document.createElement('div');
            hooksSection.innerHTML = '<h4 style="color: #FFD700; margin: 10px 0; font-size: 10px;">ü™ù ANZUELOS</h4>';
            shopItemsElement.appendChild(hooksSection);
            
            shopData.hooks.forEach(hook => {
                if (gameState.equipment.hook !== hook.id) {
                    const item = document.createElement('div');
                    item.className = 'shop-item';
                    item.innerHTML = 
                        '<div>' +
                            '<div>' + hook.name + '</div>' +
                            '<div style="font-size: 6px; color: #32CD32;">+' + hook.luckBonus + '% Suerte</div>' +
                        '</div>' +
                        '<button onclick="buyItem(\'hook\', \'' + hook.id + '\', ' + hook.price + ')" ' + (gameState.coins < hook.price ? 'disabled' : '') + '>' +
                            'üí∞ ' + hook.price +
                        '</button>';
                    shopItemsElement.appendChild(item);
                }
            });
            
            // Sedales
            const linesSection = document.createElement('div');
            linesSection.innerHTML = '<h4 style="color: #FFD700; margin: 10px 0; font-size: 10px;">üßµ SEDALES</h4>';
            shopItemsElement.appendChild(linesSection);
            
            shopData.lines.forEach(line => {
                if (gameState.equipment.line !== line.id) {
                    const item = document.createElement('div');
                    item.className = 'shop-item';
                    item.innerHTML = 
                        '<div>' +
                            '<div>' + line.name + '</div>' +
                            '<div style="font-size: 6px; color: #32CD32;">+' + line.luckBonus + '% Suerte</div>' +
                        '</div>' +
                        '<button onclick="buyItem(\'line\', \'' + line.id + '\', ' + line.price + ')" ' + (gameState.coins < line.price ? 'disabled' : '') + '>' +
                            'üí∞ ' + line.price +
                        '</button>';
                    shopItemsElement.appendChild(item);
                }
            });
            
            // Objetos especiales
            const specialSection = document.createElement('div');
            specialSection.innerHTML = '<h4 style="color: #FFD700; margin: 10px 0; font-size: 10px;">‚ú® ESPECIALES</h4>';
            shopItemsElement.appendChild(specialSection);
            
            const specialItems = [
                { name: 'Puntos de Pesca x5', price: 50 },
                { name: 'Puntos de Pesca x10', price: 90 },
                { name: 'Poci√≥n de Suerte (+50% por 10 pescas)', price: 200 }
            ];
            
            specialItems.forEach((special, index) => {
                const item = document.createElement('div');
                item.className = 'shop-item';
                item.innerHTML = 
                    '<div>' + special.name + '</div>' +
                    '<button onclick="buySpecial(' + index + ', ' + special.price + ')" ' + (gameState.coins < special.price ? 'disabled' : '') + '>' +
                        'üí∞ ' + special.price +
                    '</button>';
                shopItemsElement.appendChild(item);
            });
        }
        
        // SISTEMA DE TAREAS DE PRODUCTIVIDAD PERSONAL
        function updateTaskDisplay() {
            const taskList = document.getElementById('taskList');
            taskList.innerHTML = '';
            
            if (gameState.dailyTasks.length === 0) {
                taskList.innerHTML = '<p style="text-align: center; color: #666; font-size: 7px;">No hay tareas. ¬°A√±ade tus tareas del d√≠a para ganar puntos de pesca!</p>';
                return;
            }
            
            gameState.dailyTasks.forEach((task, index) => {
                const taskElement = document.createElement('div');
                taskElement.className = 'task-item' + (task.completed ? ' completed' : '');
                taskElement.innerHTML = 
                    '<div class="task-description">' +
                        '<div>üìù ' + task.name + '</div>' +
                        '<div style="font-size: 6px; color: #FFD700;">Recompensa: 1 punto de pesca</div>' +
                    '</div>' +
                    '<div>' +
                        '<button class="complete-btn" onclick="completeTask(' + index + ')" ' + 
                        (task.completed ? 'disabled' : '') + '>' +
                            (task.completed ? '‚úÖ Hecho' : '‚≠ê Completar') +
                        '</button>' +
                        '<button class="delete-btn" onclick="deleteTask(' + index + ')">üóëÔ∏è</button>' +
                    '</div>';
                taskList.appendChild(taskElement);
            });
        }
        
        function showAddTaskModal() {
            document.getElementById('taskModal').style.display = 'block';
            document.getElementById('taskInput').focus();
        }
        
        function closeAddTaskModal() {
            document.getElementById('taskModal').style.display = 'none';
            document.getElementById('taskInput').value = '';
        }
        
        function addNewTask() {
            const taskInput = document.getElementById('taskInput');
            const taskName = taskInput.value.trim();
            
            if (taskName === '') {
                showNotification('‚ùå Escribe una tarea v√°lida');
                return;
            }
            
            if (taskName.length > 50) {
                showNotification('‚ùå La tarea es demasiado larga (m√°x 50 caracteres)');
                return;
            }
            
            const newTask = {
                id: Date.now(), // ID √∫nico basado en timestamp
                name: taskName,
                completed: false,
                createdAt: new Date().toLocaleDateString()
            };
            
            gameState.dailyTasks.push(newTask);
            
            closeAddTaskModal();
            updateDisplay();
            showNotification('‚úÖ Tarea "' + taskName + '" a√±adida');
        }
        
        function completeTask(taskIndex) {
            const task = gameState.dailyTasks[taskIndex];
            
            if (task.completed) {
                showNotification('‚ùå Esta tarea ya est√° completada');
                return;
            }
            
            // Marcar como completada
            task.completed = true;
            task.completedAt = new Date().toLocaleTimeString();
            
            // Ganar punto de pesca
            gameState.fishingPoints += 1;
            gameState.tasksCompleted += 1;
            
            showNotification('üéâ ¬°Tarea completada! +1 punto de pesca. ¬°Bien hecho!');
            updateDisplay();
        }
        
        function deleteTask(taskIndex) {
            const task = gameState.dailyTasks[taskIndex];
            gameState.dailyTasks.splice(taskIndex, 1);
            
            showNotification('üóëÔ∏è Tarea "' + task.name + '" eliminada');
            updateDisplay();
        }
        
        function resetTasks() {
            const completedTasks = gameState.dailyTasks.filter(task => task.completed).length;
            
            if (completedTasks > 0) {
                const confirmReset = confirm('¬øEst√°s seguro? Esto borrar√° todas las tareas del d√≠a. Has completado ' + completedTasks + ' tareas hoy.');
                if (!confirmReset) return;
            }
            
            gameState.dailyTasks = [];
            showNotification('üîÑ D√≠a reiniciado. ¬°Hora de nuevas tareas!');
            updateDisplay();
        }
        
        // Event listener para Enter en el input de tareas
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Enter' && document.getElementById('taskModal').style.display === 'block') {
                addNewTask();
            }
            if (event.key === 'Escape') {
                closeAddTaskModal();
            }
        });
        
        function buyItem(type, id, price) {
            if (gameState.coins < price) {
                showNotification('‚ùå No tienes suficientes monedas');
                return;
            }
            
            gameState.coins -= price;
            gameState.equipment[type] = id;
            calculateLuckBonus();
            
            const itemType = type === 'rod' ? 'ca√±a' : type === 'hook' ? 'anzuelo' : 'sedal';
            showNotification('¬°Compraste ' + itemType + '!');
            updateDisplay();
        }
        
        function buySpecial(index, price) {
            if (gameState.coins < price) {
                showNotification('‚ùå No tienes suficientes monedas');
                return;
            }
            
            gameState.coins -= price;
            
            switch(index) {
                case 0:
                    gameState.fishingPoints += 5;
                    showNotification('¬°Compraste 5 puntos de pesca!');
                    break;
                case 1:
                    gameState.fishingPoints += 10;
                    showNotification('¬°Compraste 10 puntos de pesca!');
                    break;
                case 2:
                    gameState.tempLuckBonus = 50;
                    gameState.tempLuckUses = 10;
                    showNotification('¬°Poci√≥n de suerte activada! (+50% por 10 pescas)');
                    break;
            }
            
            updateDisplay();
        }
        
        function switchTab(tabName) {
            // Ocultar todos los contenidos
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => {
                content.classList.remove('active');
            });
            
            // Remover active de todos los tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Mostrar contenido seleccionado
            document.getElementById(tabName).classList.add('active');
            
            // Activar tab correspondiente
            const targetTab = tabName === 'shop' ? 0 : 1;
            tabs[targetTab].classList.add('active');
        }
        
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // Inicializar el juego
        function initGame() {
            calculateLuckBonus();
            generateNewTasks(); // Generar tareas iniciales
            updateDisplay();
            showNotification('¬°Bienvenido al Simulador de Pesca! üé£');
        }
        
        // Efectos visuales - burbujas
        function createBubbles() {
            setInterval(() => {
                const pond = document.querySelector('.pond');
                if (Math.random() < 0.3) {
                    const bubble = document.createElement('div');
                    bubble.style.position = 'absolute';
                    bubble.style.width = Math.random() * 10 + 5 + 'px';
                    bubble.style.height = bubble.style.width;
                    bubble.style.background = 'rgba(255,255,255,0.6)';
                    bubble.style.borderRadius = '50%';
                    bubble.style.left = Math.random() * 90 + '%';
                    bubble.style.bottom = '0px';
                    bubble.style.animation = 'bubble 3s linear forwards';
                    pond.appendChild(bubble);
                    
                    setTimeout(() => {
                        if (bubble.parentNode) bubble.parentNode.removeChild(bubble);
                    }, 3000);
                }
            }, 1000);
        }
        
        // A√±adir animaci√≥n de burbujas al CSS
        function addBubbleAnimation() {
            const style = document.createElement('style');
            style.textContent = 
                '@keyframes bubble {' +
                    '0% { bottom: 0px; opacity: 0.8; transform: translateX(0px); }' +
                    '100% { bottom: 300px; opacity: 0; transform: translateX(' + (Math.random() * 40 - 20) + 'px); }' +
                '}';
            document.head.appendChild(style);
        }
        
        // Consejos aleatorios
        function startTips() {
            const tips = [
                "üí° Mejora tu equipo para tener m√°s suerte pescando",
                "üí° Los peces m√°s raros aparecen con menos frecuencia",
                "üí° Completa tareas para ganar puntos de pesca",
                "üí° Vende tus peces para ganar monedas",
                "üí° Subir de nivel te da puntos de pesca gratis",
                "üí° Las pociones de suerte son muy √∫tiles para peces raros"
            ];
            
            setInterval(() => {
                if (Math.random() < 0.1) {
                    const randomTip = tips[Math.floor(Math.random() * tips.length)];
                    showNotification(randomTip);
                }
            }, 30000);
        }
        
        // Inicializar todo cuando la p√°gina cargue
        window.onload = function() {
            initGame();
            addBubbleAnimation();
            createBubbles();
            startTips();
        };
    </script>
</body>
</html>
